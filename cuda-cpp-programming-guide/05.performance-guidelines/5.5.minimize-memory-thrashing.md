# 5.5 메모리 스래싱 최소화

메모리를 너무 자주 할당하고 해제하는 애플리케이션은 시간이 지남에 따라 할당 호출이 점점 느려지는 것을 경험할 수 있습니다. 이는 운영 체제가 자체 사용을 위해 메모리를 회수하는 특성상 일반적으로 예상되는 현상입니다. 이와 관련하여 최상의 성능을 얻기 위해 다음과 같은 사항을 권장합니다:

- 해당 문제에 맞게 할당 크기를 조정하십시오. `cudaMalloc` / `cudaMallocHost` / `cuMemCreate`로 사용 가능한 모든 메모리를 할당하려고 하지 마십시오. 이렇게 하면 메모리가 즉시 상주해야 하고 다른 애플리케이션이 해당 메모리를 사용할 수 없게 됩니다. 이는 운영 체제 스케줄러에 더 많은 부담을 주거나, 동일한 GPU를 사용하는 다른 애플리케이션이 완전히 실행되지 못하게 할 수 있습니다.
- 애플리케이션 초기에 적절한 크기의 메모리를 할당하고, 애플리케이션이 더 이상 사용하지 않을 때만 할당을 해제하도록 하십시오. 특히 성능이 중요한 영역에서 `cudaMalloc` + `cudaFree` 호출 횟수를 줄이십시오.
- 애플리케이션이 충분한 디바이스 메모리를 할당할 수 없는 경우, `cudaMallocHost`나 `cudaMallocManaged`와 같은 다른 메모리 유형을 사용하는 것을 고려하십시오. 이러한 메모리 유형은 성능이 떨어질 수 있지만, 애플리케이션이 진행될 수 있게 해줍니다.
- 이 기능을 지원하는 플랫폼의 경우, `cudaMallocManaged`는 오버서브스크립션을 허용하며, 올바른 `cudaMemAdvise` 정책이 활성화된 경우 `cudaMalloc`의 성능을 대부분 또는 전부 유지할 수 있습니다. 또한 `cudaMallocManaged`는 필요하거나 프리페치될 때까지 할당이 상주하도록 강제하지 않으므로, 운영 체제 스케줄러에 대한 전반적인 부담을 줄이고 멀티 테넌트 사용 사례를 더 잘 지원할 수 있습니다.